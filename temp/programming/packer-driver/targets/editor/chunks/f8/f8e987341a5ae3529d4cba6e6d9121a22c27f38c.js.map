{"version":3,"sources":["file:///Users/raopinwu/workspace/ccs/fitSreen/FitScreen/extensions/magic-book/assets/src/common/base/mb_base.ts"],"names":["mb_base","mb","mb_log","ins","_ins","constructor","name","_debug_log_funcs","_info_log_funcs","conf","is_debug","self","i","length","func_name","func","p","log_debug","call","log_info","info","debug","log_warn","warn","log_error","error"],"mappings":";;;0CAGqBA,O;;;;;;;;;;;;;;;;;;AAHdC,MAAAA,E;;AACAC,MAAAA,M;;;;;;;yBAEcF,O,GAAN,MAAMA,OAAN,CAAc;AAEzB;AAEU,eAAHG,GAAG,GAAqC;AAC3C,cAAI,CAAO,IAAN,CAAYC,IAAjB,EAAuB;AACb,gBAAN,CAAYA,IAAZ,GAAmB,IAAI,IAAJ,EAAnB;AACH;;AACD,iBAAa,IAAN,CAAYA,IAAnB;AACH;AAED;AACJ;AACA;AACA;AACA;;;AASIC,QAAAA,WAAW,GAAG;AAAA,eARJC,IAQI,GARW,YAQX;AAAA,eAHdC,gBAGc,GAHe,IAGf;AAAA,eAFdC,eAEc,GAFc,IAEd;;AACV,cAAI,CAAC;AAAA;AAAA,wBAAGC,IAAH,CAAQC,QAAb,EAAuB;AACnB;AACH;;AACD,gBAAMC,IAAI,GAAG,IAAb,CAJU,CAKV;;AACA,iBAAO,KAAKJ,gBAAZ;;AACA,eAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKL,gBAAL,CAAsBM,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACnD,kBAAME,SAAS,GAAG,KAAKP,gBAAL,CAAsBK,CAAtB,CAAlB;AACA,kBAAMG,IAAI,GAAG,KAAKD,SAAL,CAAb;;AACA,iBAAKA,SAAL,IAAkB,UAAU,GAAGE,CAAb,EAAgB;AAC9BL,cAAAA,IAAI,CAACM,SAAL,CAAgB,GAAEH,SAAU,EAA5B,EAA+B,GAAGE,CAAlC;AACA,qBAAOD,IAAI,CAACG,IAAL,CAAU,IAAV,EAAgB,GAAGF,CAAnB,CAAP;AACH,aAHD;AAIH;;AACD,iBAAO,KAAKR,eAAZ;;AACA,eAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKJ,eAAL,CAAqBK,MAAzC,EAAiDD,CAAC,EAAlD,EAAsD;AAClD,kBAAME,SAAS,GAAG,KAAKN,eAAL,CAAqBI,CAArB,CAAlB;AACA,kBAAMG,IAAI,GAAG,KAAKD,SAAL,CAAb;;AACA,iBAAKA,SAAL,IAAkB,UAAU,GAAGE,CAAb,EAAgB;AAC9BL,cAAAA,IAAI,CAACQ,QAAL,CAAe,GAAEL,SAAU,EAA3B,EAA8B,GAAGE,CAAjC;AACA,qBAAOD,IAAI,CAACG,IAAL,CAAU,IAAV,EAAgB,GAAGF,CAAnB,CAAP;AACH,aAHD;AAIH;AACJ,SAhDwB,CAkDzB;;;AAEUG,QAAAA,QAAQ,CAAC,GAAGH,CAAJ,EAAO;AACrB;AAAA;AAAA,gCAAOI,IAAP,CAAa,QAAO,KAAKd,IAAK,EAA9B,EAAiC,GAAGU,CAApC;AACH;;AAESC,QAAAA,SAAS,CAAC,GAAGD,CAAJ,EAAO;AACtB;AAAA;AAAA,gCAAOK,KAAP,CAAc,SAAQ,KAAKf,IAAK,EAAhC,EAAmC,GAAGU,CAAtC;AACH;;AAESM,QAAAA,QAAQ,CAAC,GAAGN,CAAJ,EAAO;AACrB;AAAA;AAAA,gCAAOO,IAAP,CAAa,QAAO,KAAKjB,IAAK,EAA9B,EAAiC,GAAGU,CAApC;AACH;;AAESQ,QAAAA,SAAS,CAAC,GAAGR,CAAJ,EAAO;AACtB;AAAA;AAAA,gCAAOS,KAAP,CAAc,SAAQ,KAAKnB,IAAK,EAAhC,EAAmC,GAAGU,CAAtC;AACH;;AAlEwB,O","sourcesContent":["import mb from \"../../mb\";\r\nimport mb_log from \"../log/mb_log\";\r\n\r\nexport default class mb_base {\r\n\r\n    //==== 单例模式\r\n\r\n    static ins<T extends {}>(this: new () => T): T {\r\n        if (!(<any>this)._ins) {\r\n            (<any>this)._ins = new this();\r\n        }\r\n        return (<any>this)._ins;\r\n    }\r\n\r\n    /**\r\n     * 自定义类名\r\n     * 打包或混淆过程会把class定义的类压缩或混淆掉，所以需要自己定义一个\r\n     * 子类重写此变量，定义自己类名\r\n     */\r\n    protected name: string = \"magic_base\";\r\n\r\n\r\n    //==== hook\r\n\r\n    _debug_log_funcs: string[] = null;\r\n    _info_log_funcs: string[] = null;\r\n\r\n    constructor() {\r\n        if (!mb.conf.is_debug) {\r\n            return;\r\n        }\r\n        const self = this;\r\n        //删除自己的，后面才会取到原型链上的属性\r\n        delete this._debug_log_funcs;\r\n        for (let i = 0; i < this._debug_log_funcs.length; i++) {\r\n            const func_name = this._debug_log_funcs[i];\r\n            const func = this[func_name];\r\n            this[func_name] = function (...p) {\r\n                self.log_debug(`${func_name}`, ...p);\r\n                return func.call(this, ...p);\r\n            };\r\n        }\r\n        delete this._info_log_funcs;\r\n        for (let i = 0; i < this._info_log_funcs.length; i++) {\r\n            const func_name = this._info_log_funcs[i];\r\n            const func = this[func_name];\r\n            this[func_name] = function (...p) {\r\n                self.log_info(`${func_name}`, ...p);\r\n                return func.call(this, ...p);\r\n            };\r\n        }\r\n    }\r\n\r\n    //==== 日志相关\r\n\r\n    protected log_info(...p) {\r\n        mb_log.info(`info:${this.name}`, ...p);\r\n    }\r\n\r\n    protected log_debug(...p) {\r\n        mb_log.debug(`debug:${this.name}`, ...p);\r\n    }\r\n\r\n    protected log_warn(...p) {\r\n        mb_log.warn(`warn:${this.name}`, ...p);\r\n    }\r\n\r\n    protected log_error(...p) {\r\n        mb_log.error(`error:${this.name}`, ...p);\r\n    }\r\n\r\n}"]}