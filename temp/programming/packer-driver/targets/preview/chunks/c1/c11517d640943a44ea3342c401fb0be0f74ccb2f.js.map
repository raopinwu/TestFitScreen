{"version":3,"sources":["file:///Users/raopinwu/workspace/ccs/fitSreen/FitScreen/extensions/magic-book/assets/src/system/audio/mb_audio_volume_cp.ts"],"names":["_decorator","Slider","Label","mb_base_cp","mb","ccclass","property","menu","mb_audio_volume_cp","onLoad","slider_music","node","on","on_slider_music","slider_effect","on_slider_effect","progress","audio","music_volume","effect_volume","update_music_label","update_effect_label","slider","Number","toFixed","label_music","string","label_effect"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAC+BA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AAC1CC,MAAAA,U,iBAAAA,U;;AACFC,MAAAA,E;;;;;;;;;OAED;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA8BP,U;AAEpC;AACA;AACA;AACA;AACA;;oCAGaQ,kB,WAFZH,OAAO,CAAC,oBAAD,C,UACPE,IAAI,CAAC,+BAAD,C,UAGAD,QAAQ,CAACL,MAAD,C,UAGRK,QAAQ,CAACL,MAAD,C,UAGRK,QAAQ,CAACJ,KAAD,C,UAGRI,QAAQ,CAACJ,KAAD,C,0CAbb,MAEaM,kBAFb;AAAA;AAAA,oCAEmD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAc/CC,QAAAA,MAAM,GAAG;AACL,cAAI,KAAKC,YAAT,EAAuB;AACnB,iBAAKA,YAAL,CAAkBC,IAAlB,CAAuBC,EAAvB,CAA0B,OAA1B,EAAmC,KAAKC,eAAxC,EAAyD,IAAzD;;AACA,gBAAI,CAAC,KAAKC,aAAV,EAAyB;AACrB;AACA,mBAAKJ,YAAL,CAAkBC,IAAlB,CAAuBC,EAAvB,CAA0B,OAA1B,EAAmC,KAAKG,gBAAxC,EAA0D,IAA1D;AACH;;AACD,iBAAKL,YAAL,CAAkBM,QAAlB,GAA6B;AAAA;AAAA,0BAAGC,KAAH,CAASC,YAAtC;AACH;;AACD,cAAI,KAAKJ,aAAT,EAAwB;AACpB,iBAAKA,aAAL,CAAmBH,IAAnB,CAAwBC,EAAxB,CAA2B,OAA3B,EAAoC,KAAKG,gBAAzC,EAA2D,IAA3D;AACA,iBAAKD,aAAL,CAAmBE,QAAnB,GAA8B;AAAA;AAAA,0BAAGC,KAAH,CAASE,aAAvC;AACH;;AACD,eAAKC,kBAAL;AACA,eAAKC,mBAAL;AACH;;AAEDR,QAAAA,eAAe,CAACS,MAAD,EAAiB;AAC5B;AAAA;AAAA,wBAAGL,KAAH,CAASC,YAAT,GAAwBK,MAAM,CAACD,MAAM,CAACN,QAAP,CAAgBQ,OAAhB,CAAwB,CAAxB,CAAD,CAA9B;AACA,eAAKJ,kBAAL;AACH;;AAEDL,QAAAA,gBAAgB,CAACO,MAAD,EAAiB;AAC7B;AAAA;AAAA,wBAAGL,KAAH,CAASE,aAAT,GAAyBI,MAAM,CAACD,MAAM,CAACN,QAAP,CAAgBQ,OAAhB,CAAwB,CAAxB,CAAD,CAA/B;AACA,eAAKH,mBAAL;AACH;;AAEDD,QAAAA,kBAAkB,GAAG;AACjB,cAAI,KAAKK,WAAT,EAAsB;AAClB,iBAAKA,WAAL,CAAiBC,MAAjB,GAA6B,CAAC;AAAA;AAAA,0BAAGT,KAAH,CAASC,YAAT,GAAwB,GAAzB,EAA8BM,OAA9B,CAAsC,CAAtC,CAA7B;AACH;AACJ;;AAEDH,QAAAA,mBAAmB,GAAG;AAClB,cAAI,KAAKM,YAAT,EAAuB;AACnB,iBAAKA,YAAL,CAAkBD,MAAlB,GAA8B,CAAC;AAAA;AAAA,0BAAGT,KAAH,CAASE,aAAT,GAAyB,GAA1B,EAA+BK,OAA/B,CAAuC,CAAvC,CAA9B;AACH;AACJ;;AAnD8C,O;;;;;iBAGxB,I;;;;;;;iBAGC,I;;;;;;;iBAGH,I;;;;;;;iBAGC,I","sourcesContent":["\nimport { Component, AudioClip, _decorator, Slider, Label } from 'cc';\nimport { mb_base_cp } from '../../base/mb_base_cp';\nimport mb from '../../mb';\nimport mb_audio from './mb_audio';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * @name 音量管理组件\n * @des 如果只绑定了音乐，则会一起控制音效\n * https://gitee.com/magician-f/cocos-magic-book\n */\n@ccclass('mb_audio_volume_cp')\n@menu(\"magic-book/mb_audio_volume_cp\")\nexport class mb_audio_volume_cp extends mb_base_cp {\n\n    @property(Slider)\n    slider_music: Slider = null;\n\n    @property(Slider)\n    slider_effect: Slider = null;\n\n    @property(Label)\n    label_music: Label = null;\n\n    @property(Label)\n    label_effect: Label = null;\n\n    onLoad() {\n        if (this.slider_music) {\n            this.slider_music.node.on(\"slide\", this.on_slider_music, this);\n            if (!this.slider_effect) {\n                //如果没有配置音效，会同时能控制音效音量\n                this.slider_music.node.on(\"slide\", this.on_slider_effect, this);\n            }\n            this.slider_music.progress = mb.audio.music_volume;\n        }\n        if (this.slider_effect) {\n            this.slider_effect.node.on(\"slide\", this.on_slider_effect, this);\n            this.slider_effect.progress = mb.audio.effect_volume;\n        }\n        this.update_music_label();\n        this.update_effect_label();\n    }\n\n    on_slider_music(slider: Slider) {\n        mb.audio.music_volume = Number(slider.progress.toFixed(2));\n        this.update_music_label();\n    }\n\n    on_slider_effect(slider: Slider) {\n        mb.audio.effect_volume = Number(slider.progress.toFixed(2));\n        this.update_effect_label();\n    }\n\n    update_music_label() {\n        if (this.label_music) {\n            this.label_music.string = `${(mb.audio.music_volume * 100).toFixed(0)}%`;\n        }\n    }\n\n    update_effect_label() {\n        if (this.label_effect) {\n            this.label_effect.string = `${(mb.audio.effect_volume * 100).toFixed(0)}%`;\n        }\n    }\n\n}"]}