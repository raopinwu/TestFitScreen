{"version":3,"sources":["file:///Users/raopinwu/workspace/ccs/fitSreen/FitScreen/extensions/magic-book/assets/src/common/base/mb_base.ts"],"names":["mb_base","mb","mb_log","ins","_ins","constructor","name","_debug_log_funcs","_info_log_funcs","conf","is_debug","self","i","func_name","func","p","log_debug","call","length","log_info","info","debug","log_warn","warn","log_error","error"],"mappings":"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","sourcesContent":["import mb from \"../../mb\";\r\nimport mb_log from \"../log/mb_log\";\r\n\r\nexport default class mb_base {\r\n\r\n    //==== 单例模式\r\n\r\n    static ins<T extends {}>(this: new () => T): T {\r\n        if (!(<any>this)._ins) {\r\n            (<any>this)._ins = new this();\r\n        }\r\n        return (<any>this)._ins;\r\n    }\r\n\r\n    /**\r\n     * 自定义类名\r\n     * 打包或混淆过程会把class定义的类压缩或混淆掉，所以需要自己定义一个\r\n     * 子类重写此变量，定义自己类名\r\n     */\r\n    protected name: string = \"magic_base\";\r\n\r\n\r\n    //==== hook\r\n\r\n    _debug_log_funcs: string[] = null;\r\n    _info_log_funcs: string[] = null;\r\n\r\n    constructor() {\r\n        if (!mb.conf.is_debug) {\r\n            return;\r\n        }\r\n        const self = this;\r\n        //删除自己的，后面才会取到原型链上的属性\r\n        delete this._debug_log_funcs;\r\n        for (let i = 0; i < this._debug_log_funcs.length; i++) {\r\n            const func_name = this._debug_log_funcs[i];\r\n            const func = this[func_name];\r\n            this[func_name] = function (...p) {\r\n                self.log_debug(`${func_name}`, ...p);\r\n                return func.call(this, ...p);\r\n            };\r\n        }\r\n        delete this._info_log_funcs;\r\n        for (let i = 0; i < this._info_log_funcs.length; i++) {\r\n            const func_name = this._info_log_funcs[i];\r\n            const func = this[func_name];\r\n            this[func_name] = function (...p) {\r\n                self.log_info(`${func_name}`, ...p);\r\n                return func.call(this, ...p);\r\n            };\r\n        }\r\n    }\r\n\r\n    //==== 日志相关\r\n\r\n    protected log_info(...p) {\r\n        mb_log.info(`info:${this.name}`, ...p);\r\n    }\r\n\r\n    protected log_debug(...p) {\r\n        mb_log.debug(`debug:${this.name}`, ...p);\r\n    }\r\n\r\n    protected log_warn(...p) {\r\n        mb_log.warn(`warn:${this.name}`, ...p);\r\n    }\r\n\r\n    protected log_error(...p) {\r\n        mb_log.error(`error:${this.name}`, ...p);\r\n    }\r\n\r\n}"]}